const cartContainer = document.querySelector(".cart-container"), productList = document.querySelector(".product-list"); var cartList = document.querySelector(".cart-list"); const cartList2 = document.getElementById("checkoutCartList"), cartTotalValue = document.getElementById("cart-total-value"), cartCountInfo = document.getElementById("cart-count-info"), checkoutList = document.getElementById("checkoutList"), checkoutCartNum = document.querySelector("checkoutCartNum"); let cartItemID = 1; function eventListeners() { window.addEventListener("DOMContentLoaded", () => { loadJSON(), loadCart() }), document.querySelector(".navbar-toggler").addEventListener("click", () => { document.querySelector(".navbar-collapse").classList.toggle("show-navbar") }), document.getElementById("cart-btn").addEventListener("click", () => { cartContainer.classList.toggle("show-cart-container") }), productList.addEventListener("click", purchaseProduct), cartList.addEventListener("click", deleteProduct) } function updateCartInfo() { let t = findCartInfo(); cartCountInfo.textContent = t.productCount, cartTotalValue.textContent = t.total, localStorage.setItem("TotalCartInCheckOut", t.total), document.getElementById("checkoutTotal").innerHTML = `${localStorage.getItem("TotalCartInCheckOut")}`, localStorage.setItem("countNum", t.productCount) } async function loadJSON() { null != document.querySelector(".cart-list") && fetch("furniture2.json").then(t => t.json()).then(t => { t.forEach(t => { productList.innerHTML += `\n                 \n<div class="col">\n<div class="product-item">\n<div class="card">\n    <div class="product-img ">\n        <img src = "${t.imgSrc}" alt = "product image">\n    </div>\n    <div class = "product-content">\n    <h3 class = "product-name">${t.name}</h3>\n    <span class = "product-category">${t.category}</span>\n    <p class = "product-price">$${t.price}</p>\n    <button type = "button" class = "add-to-cart-btn">\n    <i class = "fas fa-shopping-cart"></i>Add To Cart\n</button>\n<button type = "button"  onclick="processProduct(${t.no})" value="" id="myBtn" class="desc-btn  btn  btn-outline-danger mb-2">Description</button>\n<input class="d-none"  value="${t.no}">\n\n</div>\n</div>\n    \n</div>\n</div>\n\n            ` }) }) } function purchaseProduct(t) { if (t.target.classList.contains("add-to-cart-btn")) { let e = t.target.parentElement.parentElement; getProductInfo(e), getProductInfo2(e) } } function getProductInfo(t) { let e = { id: cartItemID, imgSrc: t.querySelector(".product-img img").src, name: t.querySelector(".product-name").textContent, category: t.querySelector(".product-category").textContent, price: t.querySelector(".product-price").textContent }; cartItemID++, addToCartList(e), saveProductInStorage(e) } function getProductInfo2(t) { let e = { id: cartItemID, imgSrc: t.querySelector(".product-img img").src, name: t.querySelector(".product-name").textContent, category: t.querySelector(".product-category").textContent, price: t.querySelector(".product-price").textContent }; cartItemID++, addToCartList2(e), saveProductInStorage(e) } function addToCartList(t) { const e = document.createElement("div"); e.classList.add("cart-item"), e.setAttribute("data-id", `${t.id}`), e.innerHTML = `\n \n    <img src = "${t.imgSrc}" alt = "product image">\n    <div class = "cart-item-info">\n        <h3 class = "cart-item-name">${t.name}</h3>\n        <span class = "cart-item-category">${t.category}</span>\n        <span class = "cart-item-price">${t.price}</span>\n    </div>\n    \n    <button type = "button" class = "cart-item-del-btn">\n        <i class = "fas fa-times"></i>\n    </button>\n        `, cartList.appendChild(e) } function addToCartList2(t) { const e = document.createElement("div"); e.classList.add("cart-item"), e.setAttribute("data-id", `${t.id}`), e.innerHTML = `\n    <div class="card " style="width:200%">\n    <div class="row g-0">\n      <div class="col-md-4">\n        <img src="${t.imgSrc}" class="img-fluid rounded-start" alt="...">\n      </div>\n      <div class="col-md-8">\n        <div class="card-body">\n          <h5 class="card-title">${t.name}</h5>\n          <p class="card-text">${t.category}</p>\n          <p class="card-text"><small class="text-muted">${t.price}</small></p>\n        </div>\n      </div>\n    </div>\n  </div>\n\n        `, cartList2.append(e) } function saveProductInStorage(t) { let e = getProductFromStorage(); e.push(t), localStorage.setItem("products", JSON.stringify(e)), updateCartInfo() } function getProductFromStorage() { return localStorage.getItem("products") ? JSON.parse(localStorage.getItem("products")) : [] } function loadCart() { let t = getProductFromStorage(); t.length < 1 ? cartItemID = 1 : (cartItemID = t[t.length - 1].id, cartItemID++), t.forEach(t => addToCartList(t)), t.forEach(t => addToCartList2(t)), updateCartInfo() } function findCartInfo() { let t = getProductFromStorage(); return { total: t.reduce((t, e) => { return t + parseFloat(e.price.substr(1)) }, 0).toFixed(2), productCount: t.length } } function deleteProduct(t) { let e; "BUTTON" === t.target.tagName ? (e = t.target.parentElement).remove() : "I" === t.target.tagName && (e = t.target.parentElement.parentElement).remove(); let n = getProductFromStorage().filter(t => t.id !== parseInt(e.dataset.id)); localStorage.setItem("products", JSON.stringify(n)), updateCartInfo() } function checkLoginStatus() { var t = localStorage.getItem("loggedIn"), e = document.getElementById("userdetails"); 1 == t ? (document.querySelector("#loginlogout").innerHTML = "Logout", e.classList.remove("d-none"), e.classList.add("d-show")) : (e.classList.add("d-none"), e.classList.remove("d-show"), document.querySelector("#loginlogout").innerHTML = "Login", (e = document.getElementById("loginlogout")).setAttribute("href", "login.html")) } eventListeners(), checkLoginStatus(); var logout = document.getElementById("loginlogout"); function Logout() { 1 == localStorage.getItem("loggedIn") ? (localStorage.setItem("loggedIn", 0), window.location.href = "home.html") : window.location.href = "login.html" } logout.addEventListener("click", Logout);